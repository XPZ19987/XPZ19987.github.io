<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å°é¹å­çš„æ¡Œé¢å¯¼èˆª</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* éšè—Hexoä¸»é¢˜å…ƒç´  */
    #header, #navbar, #sidebar, #footer, .page-header, .site-nav, .sidebar-widget, .blog-info {
      display: none !important;
      visibility: hidden !important;
      height: 0; width: 0; margin: 0; padding: 0; border: none;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    /* èƒŒæ™¯åŠ¨å›¾è®¾ç½® */
    body {
      font-family: "Microsoft Yahei", "PingFang SC", sans-serif;
      min-height: 100vh;
      padding: 30px 20px;
      position: relative;
      overflow-x: hidden;
    }
    
    /* èƒŒæ™¯åŠ¨å›¾å±‚ - ä¸‹é›¨åŠ¨å›¾ */
    .bg-animation {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -2;
      overflow: hidden;
    }
    
    /* ä¸‹é›¨åŠ¨å›¾èƒŒæ™¯ */
    .bg-animation::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url('https://media.giphy.com/media/3o7aTskHEUdgCQAXde/giphy.gif'); /* ä¸‹é›¨åŠ¨å›¾ */
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      opacity: 0.7; /* è°ƒæ•´é€æ˜åº¦ */
      filter: blur(1px); /* è½»å¾®æ¨¡ç³Šï¼Œå‡å°‘å¯¹æ–‡å­—é˜…è¯»çš„å½±å“ */
    }
    
    /* æ¸å˜é®ç½©å±‚ï¼Œå¢å¼ºæ–‡å­—å¯è¯»æ€§ */
    .bg-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(224, 247, 250, 0.9), rgba(178, 235, 242, 0.85));
      z-index: -1;
    }
    
    /* å†…å®¹åŒºåŸŸï¼Œç¡®ä¿åœ¨èƒŒæ™¯ä¹‹ä¸Š */
    .top-area, .search-box-container, .site-grid {
      position: relative;
      z-index: 1;
    }

    /* æ¬¢è¿æ–‡å­—æ ·å¼ - ä¿®æ”¹ä¸ºå°ç«ç®­ */
    .welcome-text {
      font-size: 22px;
      font-weight: 600;
      color: #1565c0;
      margin-bottom: 10px;
      text-shadow: 1px 1px 3px rgba(255, 255, 255, 0.8);
      letter-spacing: 1px;
    }
    
    .welcome-text::after {
      content: ' ğŸš€'; /* æ”¹ä¸ºå°ç«ç®­ */
    }

    .top-area {
      text-align: center;
      margin-bottom: 30px;
    }
    .clock {
      font-size: 38px;
      font-weight: 700;
      color: #263238;
      margin-bottom: 8px;
      text-shadow: 1px 1px 3px rgba(255, 255, 255, 0.8);
    }
    .date {
      font-size: 16px;
      color: #263238;
      margin-bottom: 10px;
      text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.8);
    }
    .location-weather {
      font-size: 15px;
      color: #263238;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 25px;
      min-height: 24px;
    }
    .location-weather a {
      display: flex;
      align-items: center;
      gap: 6px;
      text-decoration: none;
      color: inherit;
      transition: all 0.2s ease;
      cursor: pointer;
      background: rgba(255, 255, 255, 0.7);
      padding: 5px 12px;
      border-radius: 20px;
      backdrop-filter: blur(5px);
      border: 1px solid rgba(66, 133, 244, 0.3);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    .location-weather a:hover {
      color: #4285f4;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      background: rgba(255, 255, 255, 0.9);
    }
    .location-icon { color: #4285f4; }
    .weather-icon { color: #ff9800; }
    .loading {
      color: #78909c;
      font-style: italic;
    }
    .error {
      color: #f44336;
      font-size: 14px;
    }
    .refresh-btn {
      background: rgba(255, 255, 255, 0.7);
      border: 1px solid rgba(66, 133, 244, 0.3);
      color: #263238;
      cursor: pointer;
      font-size: 14px;
      margin-left: 5px;
      padding: 5px 10px;
      border-radius: 50%;
      transition: all 0.2s ease;
      backdrop-filter: blur(5px);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    .refresh-btn:hover {
      color: #4285f4;
      background: rgba(255, 255, 255, 0.9);
      transform: rotate(90deg);
    }

    /* æœç´¢æ¡†æ ·å¼ - æ¨¡ä»¿å›¾ç‰‡ä¸­çš„è®¾è®¡ */
    .search-box-container {
      max-width: 680px;
      margin: 0 auto 35px auto;
    }
    
    /* æœç´¢å¼•æ“é€‰æ‹©å™¨ - éšè— */
    .search-engine-selector {
      display: none !important; /* éšè—ç™¾åº¦/å¿…åº”/GoogleæŒ‰é’®æ  */
    }
    
    .search-box {
      display: flex;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(66, 133, 244, 0.3);
    }
    
    .search-input-wrapper {
      flex: 1;
      display: flex;
      align-items: center;
      padding: 0 15px;
    }
    
    .search-engine-icon {
      color: #4285f4;
      margin-right: 10px;
      font-size: 16px;
    }
    
    .search-input {
      flex: 1;
      padding: 15px 0;
      border: none;
      outline: none;
      font-size: 15px;
      color: #263238;
      background: transparent;
      width: 100%;
    }
    
    .search-input::placeholder { 
      color: #666; 
    }
    
    .search-dropdown {
      position: relative;
      display: flex;
      align-items: center;
      padding: 0 15px;
      background: rgba(255, 255, 255, 0.9);
      border-left: 1px solid rgba(66, 133, 244, 0.2);
      cursor: pointer;
      min-width: 120px;
    }
    
    .dropdown-label {
      color: #263238;
      font-size: 14px;
      margin-right: 8px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .dropdown-arrow {
      color: #4285f4;
      font-size: 12px;
      transition: transform 0.3s ease;
    }
    
    .search-dropdown:hover .dropdown-arrow {
      transform: rotate(180deg);
    }
    
    .dropdown-menu {
      position: absolute;
      top: 100%;
      right: 0;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 8px;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
      min-width: 150px;
      z-index: 1000;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(66, 133, 244, 0.3);
      display: none;
    }
    
    .dropdown-menu.show {
      display: block;
    }
    
    .dropdown-item {
      padding: 12px 16px;
      color: #263238;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: all 0.2s ease;
    }
    
    .dropdown-item:hover {
      background: rgba(66, 133, 244, 0.1);
      color: #4285f4;
    }
    
    .dropdown-item.active {
      background: rgba(66, 133, 244, 0.2);
      color: #4285f4;
    }
    
    .search-btn {
      padding: 0 25px;
      background: #4285f4;
      color: #fff;
      border: none;
      cursor: pointer;
      font-size: 17px;
      transition: all 0.2s ease;
    }
    
    .search-btn:hover { 
      background: #3367d6; 
    }

    .site-grid {
      max-width: 1050px;
      width: 100%;
      margin: 0 auto;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(85px, 1fr));
      gap: 30px 25px;
      justify-items: center;
      padding: 0 20px;
    }
    .site-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-decoration: none;
      color: #263238;
      text-align: center;
      width: 85px;
    }
    .site-icon {
      width: 56px;
      height: 56px;
      border-radius: 16px;
      background: rgba(255, 255, 255, 0.9);
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 25px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.15);
      margin-bottom: 12px;
      transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.4);
    }
    .site-item:hover .site-icon {
      transform: scale(1.15) translateY(-5px);
      box-shadow: 0 12px 30px rgba(0,0,0,0.25);
      border-color: rgba(66, 133, 244, 0.4);
    }
    .site-name {
      font-size: 13px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      width: 100%;
      font-weight: 500;
      background: rgba(255, 255, 255, 0.8);
      padding: 3px 8px;
      border-radius: 10px;
      backdrop-filter: blur(5px);
      border: 1px solid rgba(66, 133, 244, 0.2);
    }

    /* å“åº”å¼è®¾è®¡ */
    @media (max-width: 480px) {
      .welcome-text { font-size: 18px; }
      .clock { font-size: 30px; }
      .location-weather { flex-direction: column; gap: 8px; font-size:14px; }
      .search-engine-selector { gap: 8px; }
      .search-engine-btn { padding: 6px 12px; font-size: 12px; }
      .site-grid { gap: 22px 20px; }
      .site-icon { width: 48px; height: 48px; font-size:23px; }
      .search-dropdown { min-width: 100px; padding: 0 10px; }
      .dropdown-label { font-size: 13px; }
    }
    
    /* èƒŒæ™¯åˆ‡æ¢æŒ‰é’® */
    .bg-toggle {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: rgba(255, 255, 255, 0.9);
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 100;
      box-shadow: 0 3px 10px rgba(0,0,0,0.2);
      transition: all 0.3s ease;
      color: #4285f4;
    }
    .bg-toggle:hover {
      background: #fff;
      transform: scale(1.1);
      color: #3367d6;
    }
  </style>
</head>
<body>
  <!-- èƒŒæ™¯åŠ¨å›¾å±‚ -->
  <div class="bg-animation" id="bg-animation"></div>
  
  <!-- æ¸å˜é®ç½©å±‚ -->
  <div class="bg-overlay" id="bg-overlay"></div>
  
  <!-- èƒŒæ™¯åˆ‡æ¢æŒ‰é’® -->
  <button class="bg-toggle" id="bg-toggle" title="åˆ‡æ¢èƒŒæ™¯">
    <i class="fas fa-image"></i>
  </button>

  <div class="top-area">
    <!-- æ¬¢è¿æ–‡å­— -->
    <div class="welcome-text" id="welcome-text">æ¬¢è¿æ¥åˆ°å°é¹å­çš„ç½‘ç«™</div>
    
    <div class="clock" id="clock">16:52:50</div>
    <div class="date" id="date">01æœˆ17æ—¥ æ˜ŸæœŸå…­ åä¸€æœˆå»¿ä¹ ä¹™æœª</div>
    <!-- è‡ªåŠ¨è·å–ä½ç½®å’Œå¤©æ°” -->
    <div class="location-weather" id="location-weather">
      <a id="location-link" target="_blank">
        <i class="fas fa-map-marker-alt location-icon"></i>
        <span id="location" class="loading">è·å–ä½ç½®ä¸­...</span>
      </a>
      <a id="weather-link" target="_blank">
        <i class="fas fa-cloud weather-icon"></i>
        <span id="weather" class="loading">è·å–å¤©æ°”ä¸­...</span>
      </a>
      <button class="refresh-btn" id="refresh-btn" title="åˆ·æ–°å¤©æ°”">
        <i class="fas fa-redo-alt"></i>
      </button>
    </div>
  </div>

  <!-- æœç´¢æ¡†åŒºåŸŸ -->
  <div class="search-box-container">
    <!-- æœç´¢å¼•æ“é€‰æ‹©å™¨ - å·²éšè— -->
    <div class="search-engine-selector" style="display: none;">
      <button class="search-engine-btn" data-engine="baidu">
        <i class="fab fa-baidu"></i>
        ç™¾åº¦
      </button>
      <button class="search-engine-btn active" data-engine="bing">
        <i class="fab fa-bing"></i>
        å¿…åº”
      </button>
      <button class="search-engine-btn" data-engine="google">
        <i class="fab fa-google"></i>
        Google
      </button>
    </div>
    
    <!-- æœç´¢æ¡† -->
    <div class="search-box">
      <div class="search-input-wrapper">
        <i class="fas fa-search search-engine-icon" id="search-icon"></i>
        <input type="text" class="search-input" id="search-input" placeholder="åœ¨å¿…åº”ä¸­æœç´¢å†…å®¹...">
      </div>
      
      <div class="search-dropdown" id="search-dropdown">
        <span class="dropdown-label" id="dropdown-label">
          <i class="fab fa-bing"></i>
          å¿…åº”
        </span>
        <i class="fas fa-chevron-down dropdown-arrow"></i>
        <div class="dropdown-menu" id="dropdown-menu">
          <div class="dropdown-item active" data-engine="bing">
            <i class="fab fa-bing"></i>
            å¿…åº”æœç´¢
          </div>
          <div class="dropdown-item" data-engine="baidu">
            <i class="fab fa-baidu"></i>
            ç™¾åº¦æœç´¢
          </div>
          <div class="dropdown-item" data-engine="google">
            <i class="fab fa-google"></i>
            Googleæœç´¢
          </div>
        </div>
      </div>
      
      <button class="search-btn" id="search-btn">
        <i class="fas fa-search"></i>
      </button>
    </div>
  </div>

  <div class="site-grid">
    <!-- æœç´¢ç±»ç½‘ç«™ -->
    <a href="https://www.bing.com" target="_blank" class="site-item"><div class="site-icon" style="color: #4285f4;"><i class="fab fa-bing"></i></div><div class="site-name">å¿…åº”æœç´¢</div></a>
    
    <!-- AIåŠ©æ‰‹ç½‘ç«™ -->
    <a href="https://www.doubao.com" target="_blank" class="site-item"><div class="site-icon" style="color: #ff6b6b;"><i class="fas fa-robot"></i></div><div class="site-name">è±†åŒ…</div></a>
    <a href="https://www.deepseek.com" target="_blank" class="site-item"><div class="site-icon" style="color: #4ecdc4;"><i class="fas fa-brain"></i></div><div class="site-name">deepseek</div></a>
    <a href="https://yuanbao.tencent.com" target="_blank" class="site-item"><div class="site-icon" style="color: #1e88e5;"><i class="fas fa-gem"></i></div><div class="site-name">è…¾è®¯å…ƒå®</div></a>
    <a href="https://kimi.moonshot.cn" target="_blank" class="site-item"><div class="site-icon" style="color: #ffa726;"><i class="fas fa-moon"></i></div><div class="site-name">kimi</div></a>
    <a href="https://gemini.google.com" target="_blank" class="site-item"><div class="site-icon" style="color: #4285f4;"><i class="fab fa-google"></i></div><div class="site-name">Google Gemini</div></a>
    
    <!-- è§†é¢‘å’Œç›´æ’­ç½‘ç«™ -->
    <a href="https://www.youtube.com" target="_blank" class="site-item"><div class="site-icon" style="color: #ff0000;"><i class="fab fa-youtube"></i></div><div class="site-name">YouTube</div></a>
    <a href="https://www.jrkan2023.com" target="_blank" class="site-item"><div class="site-icon" style="color: #ff9800;"><i class="fas fa-tv"></i></div><div class="site-name">JRKANç›´æ’­</div></a>
    <a href="https://www.zhibo8.com" target="_blank" class="site-item"><div class="site-icon" style="color: #2196f3;"><i class="fas fa-play-circle"></i></div><div class="site-name">ç›´æ’­å§</div></a>
    
    <!-- å…¶ä»–å®ç”¨ç½‘ç«™ -->
    <a href="https://www.bilibili.com" target="_blank" class="site-item"><div class="site-icon" style="color: #fb7299;"><i class="fab fa-bilibili"></i></div><div class="site-name">å“”å“©å“”å“©</div></a>
    <a href="https://github.com" target="_blank" class="site-item"><div class="site-icon" style="color: #333;"><i class="fab fa-github"></i></div><div class="site-name">GitHub</div></a>
    <a href="https://www.jd.com" target="_blank" class="site-item"><div class="site-icon" style="color: #e6162d;"><i class="fas fa-shopping-cart"></i></div><div class="site-name">äº¬ä¸œ</div></a>
    
    <!-- æ–°å¢ç½‘ç«™ -->
    <a href="https://www.leijing.xyz/index" target="_blank" class="site-item"><div class="site-icon" style="color: #4caf50;"><i class="fas fa-whale"></i></div><div class="site-name">é›·é²¸å°ç«™</div></a>
    <a href="https://www.haimianxz.com" target="_blank" class="site-item"><div class="site-icon" style="color: #9c27b0;"><i class="fas fa-cube"></i></div><div class="site-name">æµ·ç»µå°ç«™</div></a>
    <a href="https://dash.cloudflare.com" target="_blank" class="site-item"><div class="site-icon" style="color: #f44336;"><i class="fas fa-cloud"></i></div><div class="site-name">cloudflare</div></a>
    <a href="https://my.dnshe.com/clientarea.php" target="_blank" class="site-item"><div class="site-icon" style="color: #3f51b5;"><i class="fas fa-server"></i></div><div class="site-name">DNSHE</div></a>
  </div>

  <script>
    // é«˜å¾·åœ°å›¾APIé…ç½®
    const AMAP_KEY = 'fec8d520aa315f955cb85808c20bfb71';
    
    // èµ£å·å¸‚å„åŒºå¿adcodeæ˜ å°„ï¼ˆç”¨äºç²¾ç¡®åˆ°å¿åŒºï¼‰
    const GANZHOU_DISTRICTS = {
      'ç« è´¡åŒº': '360702',
      'å—åº·åŒº': '360703',
      'èµ£å¿åŒº': '360704',
      'ä¿¡ä¸°å¿': '360722',
      'å¤§ä½™å¿': '360723',
      'ä¸ŠçŠ¹å¿': '360724',
      'å´‡ä¹‰å¿': '360725',
      'å®‰è¿œå¿': '360726',
      'é¾™å—å¸‚': '360727',
      'å®šå—å¿': '360728',
      'å…¨å—å¿': '360729',
      'å®éƒ½å¿': '360730',
      'äºéƒ½å¿': '360731',
      'å…´å›½å¿': '360732',
      'ä¼šæ˜Œå¿': '360733',
      'å¯»ä¹Œå¿': '360734',
      'çŸ³åŸå¿': '360735',
      'ç‘é‡‘å¸‚': '360781'
    };
    
    // ç¼“å­˜æ•°æ®
    let cachedLocationData = null;
    let cachedWeatherData = null;
    let lastFetchTime = 0;
    const CACHE_DURATION = 30 * 60 * 1000; // 30åˆ†é’Ÿç¼“å­˜
    
    // èƒŒæ™¯åŠ¨å›¾åˆ—è¡¨
    const backgroundAnimations = [
      // å½“å‰ä½¿ç”¨çš„ä¸‹é›¨åŠ¨å›¾
      {
        type: 'gif',
        url: 'https://media.giphy.com/media/3o7aTskHEUdgCQAXde/giphy.gif',
        name: 'ä¸‹é›¨',
        overlayColor: 'linear-gradient(135deg, rgba(224, 247, 250, 0.9), rgba(178, 235, 242, 0.85))'
      },
      // æ˜Ÿç©ºèƒŒæ™¯
      {
        type: 'gif',
        url: 'https://media.giphy.com/media/l3vR85PnGsBwu1PFK/giphy.gif',
        name: 'æ˜Ÿç©º',
        overlayColor: 'linear-gradient(135deg, rgba(224, 247, 250, 0.85), rgba(178, 235, 242, 0.9))'
      },
      // ç²’å­èƒŒæ™¯
      {
        type: 'gif', 
        url: 'https://media.giphy.com/media/xT5LMHxhOfscxPfIfm/giphy.gif',
        name: 'ç²’å­',
        overlayColor: 'linear-gradient(135deg, rgba(240, 248, 255, 0.9), rgba(220, 240, 255, 0.85))'
      }
    ];
    
    let currentBgIndex = 0;
    
    // æœç´¢å¼•æ“é…ç½®
    const searchEngines = {
      bing: {
        name: 'å¿…åº”',
        url: 'https://www.bing.com/search?q=',
        icon: 'fab fa-bing',
        color: '#4285f4',
        placeholder: 'åœ¨å¿…åº”ä¸­æœç´¢å†…å®¹...'
      },
      baidu: {
        name: 'ç™¾åº¦',
        url: 'https://www.baidu.com/s?wd=',
        icon: 'fab fa-baidu',
        color: '#2932e1',
        placeholder: 'åœ¨ç™¾åº¦ä¸­æœç´¢å†…å®¹...'
      },
      google: {
        name: 'Google',
        url: 'https://www.google.com/search?q=',
        icon: 'fab fa-google',
        color: '#4285f4',
        placeholder: 'åœ¨Googleä¸­æœç´¢å†…å®¹...'
      }
    };
    
    let currentEngine = 'bing'; // é»˜è®¤æœç´¢å¼•æ“
    
    // å†œå†æ—¥æœŸè®¡ç®—å‡½æ•°
    function getLunarDate(date) {
      // ç®€å•çš„å†œå†è®¡ç®—ï¼ˆç®€åŒ–ç‰ˆï¼Œä»…ç”¨äºæ¼”ç¤ºï¼‰
      // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå»ºè®®ä½¿ç”¨å®Œæ•´çš„å†œå†åº“
      const lunarMonths = [
        'æ­£æœˆ', 'äºŒæœˆ', 'ä¸‰æœˆ', 'å››æœˆ', 'äº”æœˆ', 'å…­æœˆ', 
        'ä¸ƒæœˆ', 'å…«æœˆ', 'ä¹æœˆ', 'åæœˆ', 'å†¬æœˆ', 'è…Šæœˆ'
      ];
      
      const lunarDays = [
        'åˆä¸€', 'åˆäºŒ', 'åˆä¸‰', 'åˆå››', 'åˆäº”', 'åˆå…­', 'åˆä¸ƒ', 'åˆå…«', 'åˆä¹', 'åˆå',
        'åä¸€', 'åäºŒ', 'åä¸‰', 'åå››', 'åäº”', 'åå…­', 'åä¸ƒ', 'åå…«', 'åä¹', 'äºŒå',
        'å»¿ä¸€', 'å»¿äºŒ', 'å»¿ä¸‰', 'å»¿å››', 'å»¿äº”', 'å»¿å…­', 'å»¿ä¸ƒ', 'å»¿å…«', 'å»¿ä¹', 'ä¸‰å'
      ];
      
      // ç®€å•çš„å¹²æ”¯è®¡ç®—ï¼ˆä»…ç”¨äºæ¼”ç¤ºï¼Œå®é™…éœ€è¦å®Œæ•´ç®—æ³•ï¼‰
      const heavenlyStems = ['ç”²', 'ä¹™', 'ä¸™', 'ä¸', 'æˆŠ', 'å·±', 'åºš', 'è¾›', 'å£¬', 'ç™¸'];
      const earthlyBranches = ['å­', 'ä¸‘', 'å¯…', 'å¯', 'è¾°', 'å·³', 'åˆ', 'æœª', 'ç”³', 'é…‰', 'æˆŒ', 'äº¥'];
      
      // æ¼”ç¤ºæ•°æ®ï¼šæ¨¡æ‹Ÿè·å–å†œå†æ—¥æœŸ
      const month = date.getMonth() + 1;
      const day = date.getDate();
      
      // ç®€å•çš„å†œå†è®¡ç®—ï¼ˆæ¼”ç¤ºç”¨ï¼Œå®é™…åº”ä½¿ç”¨å†œå†åº“ï¼‰
      // è¿™é‡Œä¸ºäº†æ¼”ç¤ºï¼Œä½¿ç”¨å›ºå®šå€¼ï¼šå†œå†åä¸€æœˆå»¿ä¹
      const lunarMonth = 'åä¸€æœˆ';
      const lunarDay = 'å»¿ä¹';
      
      // ç®€å•çš„å¹²æ”¯è®¡ç®—ï¼ˆæ¼”ç¤ºç”¨ï¼‰
      // è¿™é‡Œä¸ºäº†æ¼”ç¤ºï¼Œä½¿ç”¨å›ºå®šå€¼ï¼šä¹™æœª
      const ganzhi = 'ä¹™æœª';
      
      return {
        month: lunarMonth,
        day: lunarDay,
        ganzhi: ganzhi
      };
    }
    
    // å®æ—¶æ—¶é—´æ›´æ–° - æŒ‰ç…§å›¾ç‰‡æ ¼å¼æ˜¾ç¤º
    function updateTime() {
      const now = new Date();
      
      // æ—¶é—´éƒ¨åˆ†: 16:52:50
      const timeStr = now.toLocaleTimeString('zh-CN', {
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
        hour12: false
      });
      
      // æ—¥æœŸéƒ¨åˆ†: 01æœˆ17æ—¥ æ˜ŸæœŸå…­
      const monthStr = (now.getMonth() + 1).toString().padStart(2, '0');
      const dayStr = now.getDate().toString().padStart(2, '0');
      const weekArr = ['æ˜ŸæœŸæ—¥', 'æ˜ŸæœŸä¸€', 'æ˜ŸæœŸäºŒ', 'æ˜ŸæœŸä¸‰', 'æ˜ŸæœŸå››', 'æ˜ŸæœŸäº”', 'æ˜ŸæœŸå…­'];
      const weekStr = weekArr[now.getDay()];
      
      // è·å–å†œå†æ—¥æœŸ
      const lunarDate = getLunarDate(now);
      
      // ç»„åˆæˆå®Œæ•´çš„æ—¥æœŸå­—ç¬¦ä¸²: 01æœˆ17æ—¥ æ˜ŸæœŸå…­ åä¸€æœˆå»¿ä¹ ä¹™æœª
      const dateStr = `${monthStr}æœˆ${dayStr}æ—¥ ${weekStr} ${lunarDate.month}${lunarDate.day} ${lunarDate.ganzhi}`;
      
      // æ›´æ–°é¡µé¢æ˜¾ç¤º
      document.getElementById('clock').textContent = timeStr;
      document.getElementById('date').textContent = dateStr;
    }
    
    updateTime();
    setInterval(updateTime, 1000);

    // åˆ‡æ¢æœç´¢å¼•æ“
    function switchSearchEngine(engine) {
      currentEngine = engine;
      const engineConfig = searchEngines[engine];
      
      // æ›´æ–°ä¸‹æ‹‰èœå•æ ‡ç­¾
      const dropdownLabel = document.getElementById('dropdown-label');
      dropdownLabel.innerHTML = `<i class="${engineConfig.icon}"></i>${engineConfig.name}`;
      
      // æ›´æ–°è¾“å…¥æ¡†å ä½ç¬¦
      document.getElementById('search-input').placeholder = engineConfig.placeholder;
      
      // æ›´æ–°ä¸‹æ‹‰èœå•ä¸­çš„é€‰ä¸­é¡¹
      const dropdownItems = document.querySelectorAll('.dropdown-item');
      dropdownItems.forEach(item => {
        if (item.dataset.engine === engine) {
          item.classList.add('active');
        } else {
          item.classList.remove('active');
        }
      });
    }
    
    // æœç´¢åŠŸèƒ½
    function doSearch() {
      const keyword = document.getElementById('search-input').value.trim();
      if (keyword) {
        const engineConfig = searchEngines[currentEngine];
        window.open(`${engineConfig.url}${encodeURIComponent(keyword)}`, '_blank');
        document.getElementById('search-input').value = '';
      }
    }
    
    // æœç´¢æŒ‰é’®ç‚¹å‡»äº‹ä»¶
    document.getElementById('search-btn').addEventListener('click', doSearch);
    
    // æœç´¢æ¡†å›è½¦äº‹ä»¶
    document.getElementById('search-input').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') doSearch();
    });
    
    // ä¸‹æ‹‰èœå•æ˜¾ç¤º/éšè—
    const dropdown = document.getElementById('search-dropdown');
    const dropdownMenu = document.getElementById('dropdown-menu');
    
    dropdown.addEventListener('click', (e) => {
      e.stopPropagation();
      dropdownMenu.classList.toggle('show');
    });
    
    // ä¸‹æ‹‰èœå•é¡¹ç‚¹å‡»äº‹ä»¶
    document.querySelectorAll('.dropdown-item').forEach(item => {
      item.addEventListener('click', () => {
        switchSearchEngine(item.dataset.engine);
        dropdownMenu.classList.remove('show');
      });
    });
    
    // ç‚¹å‡»é¡µé¢å…¶ä»–åŒºåŸŸå…³é—­ä¸‹æ‹‰èœå•
    document.addEventListener('click', () => {
      dropdownMenu.classList.remove('show');
    });
    
    // é˜»æ­¢ä¸‹æ‹‰èœå•å†…éƒ¨ç‚¹å‡»äº‹ä»¶å†’æ³¡
    dropdownMenu.addEventListener('click', (e) => {
      e.stopPropagation();
    });

    // è·å–ä½ç½®å’Œå¤©æ°”
    async function getLocationAndWeather() {
      const locationElement = document.querySelector('#location');
      const weatherElement = document.querySelector('#weather');
      const weatherIcon = document.querySelector('#weather i');
      const locationLink = document.getElementById('location-link');
      const weatherLink = document.getElementById('weather-link');
      
      // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
      locationElement.textContent = 'è·å–ä½ç½®ä¸­...';
      locationElement.className = 'loading';
      weatherElement.textContent = 'è·å–å¤©æ°”ä¸­...';
      weatherElement.className = 'loading';
      
      // æ£€æŸ¥ç¼“å­˜
      const now = Date.now();
      if (cachedLocationData && cachedWeatherData && (now - lastFetchTime) < CACHE_DURATION) {
        displayCachedData();
        return;
      }
      
      try {
        // æ–¹æ³•1: ä½¿ç”¨ip-api.comï¼ˆå…è´¹ã€æ— éœ€keyã€å¯è·å–å¿åŒºï¼‰
        let locationData = null;
        let exactLocationText = '';
        let cityCode = '360700'; // é»˜è®¤èµ£å·å¸‚
        
        try {
          const ipApiResponse = await fetch('https://ip-api.com/json/?lang=zh-CN&fields=status,message,country,regionName,city,district,lat,lon,query');
          
          if (ipApiResponse.ok) {
            locationData = await ipApiResponse.json();
            
            if (locationData.status === 'success') {
              // ä¼˜å…ˆä½¿ç”¨districtï¼ˆå¿åŒºï¼‰ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨cityï¼ˆå¸‚ï¼‰
              if (locationData.district && locationData.district !== '') {
                exactLocationText = `${locationData.regionName}${locationData.city}${locationData.district}`;
                // å°è¯•ä»èµ£å·å¸‚åŒºå¿æ˜ å°„ä¸­è·å–adcode
                for (const [districtName, adcode] of Object.entries(GANZHOU_DISTRICTS)) {
                  if (locationData.district.includes(districtName)) {
                    cityCode = adcode;
                    break;
                  }
                }
              } else if (locationData.city) {
                exactLocationText = `${locationData.regionName}${locationData.city}`;
                // å¦‚æœæ˜¯èµ£å·å¸‚ï¼Œé»˜è®¤ä½¿ç”¨ç« è´¡åŒº
                if (locationData.city.includes('èµ£å·')) {
                  cityCode = '360702'; // ç« è´¡åŒº
                }
              } else {
                exactLocationText = `${locationData.regionName}`;
              }
            }
          }
        } catch (ipApiError) {
          console.warn('ip-api.comå®šä½å¤±è´¥:', ipApiError);
        }
        
        // æ–¹æ³•2: å¦‚æœip-apiå¤±è´¥ï¼Œä½¿ç”¨é«˜å¾·IPå®šä½
        if (!exactLocationText) {
          try {
            const amapUrl = `https://restapi.amap.com/v3/ip?key=${AMAP_KEY}`;
            const amapResponse = await fetch(amapUrl);
            
            if (amapResponse.ok) {
              const amapData = await amapResponse.json();
              
              if (amapData.status === '1') {
                if (amapData.province && amapData.city) {
                  if (amapData.province === amapData.city) {
                    exactLocationText = `${amapData.province}`;
                  } else {
                    const province = amapData.province.replace(/[çœ|å¸‚|è‡ªæ²»åŒº|ç‰¹åˆ«è¡Œæ”¿åŒº]$/, '');
                    const city = amapData.city.replace(/[å¸‚|åœ°åŒº|ç›Ÿ|å·]$/, '');
                    exactLocationText = `${province}${city}`;
                  }
                  cityCode = amapData.adcode || '360700';
                }
              }
            }
          } catch (amapError) {
            console.warn('é«˜å¾·å®šä½å¤±è´¥:', amapError);
          }
        }
        
        // æ–¹æ³•3: å¦‚æœä»¥ä¸Šéƒ½å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤ä½ç½®ï¼ˆæ±Ÿè¥¿èµ£å·ç« è´¡åŒºï¼‰
        if (!exactLocationText) {
          exactLocationText = 'æ±Ÿè¥¿èµ£å·ç« è´¡åŒº';
          cityCode = '360702';
        }
        
        // è®¾ç½®ä½ç½®é“¾æ¥ï¼ˆè·³è½¬åˆ°ç™¾åº¦åœ°å›¾ï¼‰
        const baiduMapUrl = `https://map.baidu.com/search/${encodeURIComponent(exactLocationText)}`;
        locationLink.href = baiduMapUrl;
        
        locationElement.textContent = exactLocationText;
        locationElement.classList.remove('loading');
        
        // è·å–å¤©æ°”ä¿¡æ¯
        try {
          // ä½¿ç”¨é«˜å¾·å¤©æ°”API
          const weatherUrl = `https://restapi.amap.com/v3/weather/weatherInfo?key=${AMAP_KEY}&city=${cityCode}&extensions=base`;
          const weatherResponse = await fetch(weatherUrl);
          
          if (weatherResponse.ok) {
            const weatherData = await weatherResponse.json();
            
            if (weatherData.status === '1' && weatherData.lives && weatherData.lives.length > 0) {
              const weatherInfo = weatherData.lives[0];
              const temp = weatherInfo.temperature;
              const weatherDesc = weatherInfo.weather;
              
              // æ˜¾ç¤ºå¤©æ°”ä¿¡æ¯
              weatherElement.textContent = `${weatherDesc} ${temp}â„ƒ`;
              
              // è®¾ç½®å¤©æ°”é“¾æ¥ï¼ˆä½¿ç”¨è…¾è®¯å¤©æ°”ï¼‰
              const weatherDetailUrl = `https://tianqi.qq.com/?city=${encodeURIComponent(exactLocationText.replace(/[çœå¸‚åŒºå¿]/g, ''))}`;
              weatherLink.href = weatherDetailUrl;
              
              // æ›´æ–°å¤©æ°”å›¾æ ‡
              updateWeatherIconByAmap(weatherIcon, weatherDesc);
              
              // ç¼“å­˜æ•°æ®
              cachedLocationData = {
                locationText: exactLocationText,
                cityCode,
                mapUrl: baiduMapUrl,
                weatherUrl: weatherDetailUrl
              };
              cachedWeatherData = {
                temp,
                weatherDesc
              };
              lastFetchTime = now;
            } else {
              throw new Error('å¤©æ°”æ•°æ®è§£æå¤±è´¥');
            }
          } else {
            throw new Error('å¤©æ°”APIè¯·æ±‚å¤±è´¥');
          }
        } catch (weatherError) {
          console.warn('å¤©æ°”è·å–å¤±è´¥:', weatherError);
          showFallbackWeather(cityCode, exactLocationText);
        }
        
        weatherElement.classList.remove('loading');
        
      } catch (error) {
        console.error('è·å–ä½ç½®ä¿¡æ¯å¤±è´¥:', error);
        showErrorInfo();
      }
    }
    
    // æ˜¾ç¤ºç¼“å­˜çš„æ•°æ®
    function displayCachedData() {
      const locationElement = document.querySelector('#location');
      const weatherElement = document.querySelector('#weather');
      const weatherIcon = document.querySelector('#weather i');
      const locationLink = document.getElementById('location-link');
      const weatherLink = document.getElementById('weather-link');
      
      locationElement.textContent = cachedLocationData.locationText;
      locationElement.classList.remove('loading');
      locationLink.href = cachedLocationData.mapUrl;
      
      weatherElement.textContent = `${cachedWeatherData.weatherDesc} ${cachedWeatherData.temp}â„ƒ`;
      updateWeatherIconByAmap(weatherIcon, cachedWeatherData.weatherDesc);
      weatherElement.classList.remove('loading');
      weatherLink.href = cachedLocationData.weatherUrl;
    }
    
    // æ˜¾ç¤ºå¤‡ç”¨å¤©æ°”ä¿¡æ¯
    function showFallbackWeather(cityCode, locationText) {
      const weatherElement = document.querySelector('#weather');
      const weatherIcon = document.querySelector('#weather i');
      const weatherLink = document.getElementById('weather-link');
      
      // æ ¹æ®å­£èŠ‚æ˜¾ç¤ºå¤§è‡´å¤©æ°”
      const month = new Date().getMonth() + 1;
      let season = '';
      let tempRange = '';
      
      if (month >= 3 && month <= 5) {
        season = 'æ˜¥å­£';
        tempRange = '15-25Â°C';
      } else if (month >= 6 && month <= 8) {
        season = 'å¤å­£';
        tempRange = '25-35Â°C';
      } else if (month >= 9 && month <= 11) {
        season = 'ç§‹å­£';
        tempRange = '15-28Â°C';
      } else {
        season = 'å†¬å­£';
        tempRange = '5-15Â°C';
      }
      
      weatherElement.textContent = `${season} ${tempRange}`;
      weatherIcon.className = 'fas fa-cloud-sun weather-icon';
      weatherIcon.style.color = '#ff9800';
      weatherElement.classList.remove('loading');
      
      // è®¾ç½®å¤‡ç”¨å¤©æ°”é“¾æ¥ï¼ˆä½¿ç”¨è…¾è®¯å¤©æ°”ï¼‰
      weatherLink.href = `https://tianqi.qq.com/?city=${encodeURIComponent('èµ£å·')}`;
    }
    
    // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
    function showErrorInfo() {
      const locationElement = document.querySelector('#location');
      const weatherElement = document.querySelector('#weather');
      const locationLink = document.getElementById('location-link');
      const weatherLink = document.getElementById('weather-link');
      
      locationElement.textContent = 'æ±Ÿè¥¿èµ£å·ç« è´¡åŒº';
      locationElement.classList.remove('loading');
      locationElement.classList.remove('error');
      locationLink.href = 'https://map.baidu.com/search/æ±Ÿè¥¿èµ£å·ç« è´¡åŒº';
      
      weatherElement.textContent = 'å¤šäº‘ 22â„ƒ';
      weatherElement.classList.remove('loading');
      weatherElement.classList.remove('error');
      weatherLink.href = 'https://tianqi.qq.com/?city=èµ£å·';
      
      // è®¾ç½®é»˜è®¤å›¾æ ‡
      const weatherIcon = document.querySelector('#weather i');
      weatherIcon.className = 'fas fa-cloud-sun weather-icon';
      weatherIcon.style.color = '#ff9800';
    }
    
    // æ ¹æ®é«˜å¾·å¤©æ°”æè¿°æ›´æ–°å›¾æ ‡
    function updateWeatherIconByAmap(iconElement, weatherDesc) {
      const desc = weatherDesc || '';
      
      // æ¸…é™¤ä¹‹å‰çš„é¢œè‰²è®¾ç½®
      iconElement.style.color = '';
      
      // é«˜å¾·å¤©æ°”çŠ¶æ€æ˜ å°„
      if (desc.includes('æ™´')) {
        if (desc.includes('å¤šäº‘') || desc.includes('é—´')) {
          iconElement.className = 'fas fa-cloud-sun weather-icon';
          iconElement.style.color = '#ff9800';
        } else {
          iconElement.className = 'fas fa-sun weather-icon';
          iconElement.style.color = '#ff9800';
        }
      } else if (desc.includes('å¤šäº‘')) {
        iconElement.className = 'fas fa-cloud weather-icon';
        iconElement.style.color = '#78909c';
      } else if (desc.includes('é˜´')) {
        iconElement.className = 'fas fa-cloud weather-icon';
        iconElement.style.color = '#607d8b';
      } else if (desc.includes('é›¨')) {
        if (desc.includes('é›·')) {
          iconElement.className = 'fas fa-bolt weather-icon';
          iconElement.style.color = '#ff9800';
        } else if (desc.includes('å°é›¨') || desc.includes('é˜µé›¨')) {
          iconElement.className = 'fas fa-cloud-rain weather-icon';
          iconElement.style.color = '#4285f4';
        } else if (desc.includes('ä¸­é›¨')) {
          iconElement.className = 'fas fa-cloud-rain weather-icon';
          iconElement.style.color = '#1a73e8';
        } else if (desc.includes('å¤§é›¨') || desc.includes('æš´é›¨')) {
          iconElement.className = 'fas fa-cloud-showers-heavy weather-icon';
          iconElement.style.color = '#0d47a1';
        } else {
          iconElement.className = 'fas fa-cloud-rain weather-icon';
          iconElement.style.color = '#4285f4';
        }
      } else if (desc.includes('é›ª')) {
        iconElement.className = 'fas fa-snowflake weather-icon';
        iconElement.style.color = '#b2ebf2';
      } else if (desc.includes('é›¾') || desc.includes('éœ¾')) {
        iconElement.className = 'fas fa-smog weather-icon';
        iconElement.style.color = '#9e9e9e';
      } else if (desc.includes('æ²™') || desc.includes('å°˜')) {
        iconElement.className = 'fas fa-wind weather-icon';
        iconElement.style.color = '#8d6e63';
      } else {
        // é»˜è®¤å›¾æ ‡
        iconElement.className = 'fas fa-cloud-sun weather-icon';
        iconElement.style.color = '#ff9800';
      }
    }
    
    // åˆ·æ–°æŒ‰é’®åŠŸèƒ½
    document.getElementById('refresh-btn').addEventListener('click', () => {
      // æ¸…é™¤ç¼“å­˜
      cachedLocationData = null;
      cachedWeatherData = null;
      lastFetchTime = 0;
      
      // æ˜¾ç¤ºåˆ·æ–°çŠ¶æ€
      const refreshBtn = document.getElementById('refresh-btn');
      refreshBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
      
      // é‡æ–°è·å–
      getLocationAndWeather().finally(() => {
        // æ¢å¤æŒ‰é’®çŠ¶æ€
        setTimeout(() => {
          refreshBtn.innerHTML = '<i class="fas fa-redo-alt"></i>';
        }, 500);
      });
    });
    
    // èƒŒæ™¯åˆ‡æ¢åŠŸèƒ½
    function setupBackgroundToggle() {
      const bgToggle = document.getElementById('bg-toggle');
      const bgAnimation = document.getElementById('bg-animation');
      const bgOverlay = document.getElementById('bg-overlay');
      
      bgToggle.addEventListener('click', () => {
        // å¾ªç¯åˆ‡æ¢èƒŒæ™¯
        currentBgIndex = (currentBgIndex + 1) % backgroundAnimations.length;
        const bg = backgroundAnimations[currentBgIndex];
        
        // æ›´æ–°èƒŒæ™¯
        bgAnimation.style.backgroundImage = `url('${bg.url}')`;
        bgOverlay.style.background = bg.overlayColor;
        
        // æ˜¾ç¤ºé€šçŸ¥
        showNotification(`å·²åˆ‡æ¢åˆ° ${bg.name} èƒŒæ™¯`);
      });
    }
    
    // æ˜¾ç¤ºé€šçŸ¥
    function showNotification(message) {
      // ç§»é™¤å·²æœ‰çš„é€šçŸ¥
      const existingNotification = document.querySelector('.bg-notification');
      if (existingNotification) {
        existingNotification.remove();
      }
      
      // åˆ›å»ºæ–°é€šçŸ¥
      const notification = document.createElement('div');
      notification.className = 'bg-notification';
      notification.textContent = message;
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: rgba(255, 255, 255, 0.9);
        color: #263238;
        padding: 10px 20px;
        border-radius: 20px;
        z-index: 1000;
        font-size: 14px;
        animation: fadeInOut 3s ease;
        border: 1px solid rgba(66, 133, 244, 0.3);
        backdrop-filter: blur(10px);
        box-shadow: 0 3px 10px rgba(0,0,0,0.2);
      `;
      
      // æ·»åŠ åŠ¨ç”»æ ·å¼
      if (!document.querySelector('#notification-animation')) {
        const style = document.createElement('style');
        style.id = 'notification-animation';
        style.textContent = `
          @keyframes fadeInOut {
            0% { opacity: 0; transform: translateY(-10px); }
            10% { opacity: 1; transform: translateY(0); }
            90% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-10px); }
          }
        `;
        document.head.appendChild(style);
      }
      
      document.body.appendChild(notification);
      
      // 3ç§’åç§»é™¤é€šçŸ¥
      setTimeout(() => {
        if (notification.parentNode) {
          notification.parentNode.removeChild(notification);
        }
      }, 3000);
    }
    
    // é¡µé¢åŠ è½½å®Œæˆåè·å–ä½ç½®å’Œå¤©æ°”
    document.addEventListener('DOMContentLoaded', () => {
      getLocationAndWeather();
      setupBackgroundToggle();
    });
    
    // æ¯30åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡å¤©æ°”ï¼ˆé¿å…é¢‘ç¹è°ƒç”¨APIï¼‰
    setInterval(getLocationAndWeather, 30 * 60 * 1000);
  </script>
</body>
</html>